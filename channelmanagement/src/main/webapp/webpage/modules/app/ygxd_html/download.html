<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>阳光保呗下载</title>
	<meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no" name="viewport" />
    <meta name="format-detection" content="telephone=no"/>
    <meta name="apple-mobile-web-app-status-bar-style"  />
    <!-- 设置不读取缓存 -->
    <meta http-equiv="Expires" content="0">
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-control" content="no-cache">
	<meta http-equiv="Cache" content="no-cache">
	
	<link rel="stylesheet" type="text/css" href="css/common.css">
	<script src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/appPublic.js"></script>

	<script type="text/javascript">
		var dAndroidUrl = "https://ygxd.sinosig.com/manhattan/apk/ygbb-v120.apk";
		var dIosUrl = "itms-services://?action=download-manifest&url=https://ygxd.sinosig.com/manhattan/manifest.plist";
		//通过userAgent与platform来判断当前手机是否是android
		var isAndroid = !!navigator.userAgent.match(/android/ig);
		var isAndroid2 = navigator.platform.indexOf('Linux') > -1;
        var	isIos = !!navigator.userAgent.match(/iphone|ipad|ipod/ig);
        var isWx = !!navigator.userAgent.match(/MicroMessenger/ig);

        var LocString = String(window.document.location.href); 
        var channelUrl = decodeURI(getQueryStr(LocString, "downloadUrl"));

		$(document).ready(function(){
			$("#download_app").click(function(){
				// alert(navigator.platform);
				//先开始下载app
				downloadApp();
				
			});

			//mask添加触摸事件
			$("#guid_mask").bind("touchmove",function(e){
				e.preventDefault();
				e.stopPropagation();
			});
		
		});


		//下载app
		function downloadApp(){
			// alert("下载isAndroid:" + isAndroid+ " isIos:" + isIos + " " + "isWx:" + isWx + " " + navigator.userAgent + "--" + navigator.platform);
			if(isWx){
				// alert("请在手机浏览器中打开！");
				$("#guid_mask").toggle();
			}else if(isAndroid || isAndroid2){
				// alert("Android下载");
				if(isEmpty(channelUrl)){
					// alert("dAndroidUrl");
					$(location).attr('href', dAndroidUrl);
				}else{
					// alert("channelUrl:" + channelUrl);
					$(location).attr('href', channelUrl);
				}
			}else if(isIos){
				//ios
				// alert("此链接暂只支持安卓，IOS火速上线中！");
				
				// var el = $(this);
				// var link = el.attr('href');
				// window.location = link;
				// window.location.href='itms-services://?action=download-manifest&url=https://ygxd.sinosig.com/manhattan/manifest.plist';
				// window.location.href='itms-services://?action=download-manifest&url=https://wysd.ydjfin.com:8443/wuyousandai.plist';
				$(location).attr('href', dIosUrl);
				showInIos();
			}else{
				//其他。。。
				alert("请在手机端浏览器打开！");
			}
		}

		//ios中显示安装提示
		function showInIos(){
			//然后ios滚动到提示页
			if($("#ins_exp").css("display")=='none'){
				$("#ins_exp").css("display", "inline");	
				setTimeout("scrollTopExplain()",300);
			}else {
				scrollTopExplain();
			}
		}

		//滚动到下一页
		function scrollTopExplain(){
			$("html,body").animate({scrollTop:$("#ins_img1").offset().top},500)
		}


	</script>

	<style type="text/css">
		.mark{  
    		position:fixed;  
    		left:0;  
    		top:0;  
    		width:100%;  
    		height:100%;  
    		background:rgba(0,0,0,0.5);  
    		z-index:998;  
    		display: none;
    		/*opacity:.5;  */
    		/*pointer-events: none; //使用此属性，可点击遮罩下的元素事件  */
		}  
	</style>



</head>
<body>
	<div id="guid_mask" class="mark" style="cursor: pointer;">
		<img src="img/wx_prompt.png" style="width: 80%; margin: 1rem 5% 0 15%;">
	</div>
	<div>
		<img id="to_app" style="width: 100%; display: block;" src="img/download1.png">
		<img style="width: 100%; display: block;" src="img/download2.png">
		
	</div>
	<div style="float: left; position: relative; width: 100%">
		<img style="width: 100%; display: block;" src="img/download3.png">
		<img style="width: 100%; display: block;" src="img/download4.png">
		<img id="download_app" style="display: block; position: absolute; width: 90%; margin-left: 3.5%; top: 35%; cursor: pointer;" src="img/download_button.png">
	
	</div>


	<div id="ins_exp" style="display: none;">
		<img id="ins_img1" style="width: 100%; display: block;" src="img/install_exlpain1.png">
		<img style="width: 100%; display: block;" src="img/install_exlpain2.png">
		<img style="width: 100%; display: block;" src="img/install_exlpain3.png">
		<img style="width: 100%; display: block;" src="img/install_exlpain4.png">
	</div>

</body>
</html>